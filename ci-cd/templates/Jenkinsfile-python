pipeline {
  agent any
  stages {
    stage("Build") { steps { sh "docker build -t python-app ." } }
    stage("Test") { steps { sh "pytest tests" } }
    stage("Deploy") { steps { sh "docker stack deploy -c docker-compose.yml python_app" } }
  }
}
